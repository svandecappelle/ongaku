section.sidebar.show
	.user-sidebar
		h1 Library
		.search
			.row
				.col-lg-8
					.input-group
						span.input-group-addon
							i.glyphicon.glyphicon-search
						input.form-control(type="text", placeholder="Search", style="height:39px")
				.btn-group.col-lg-4
					button.btn.btn-default.dropdown-toggle(style="height:39px", type="button", data-toggle="dropdown" aria-expanded="false") Group by
						span.caret(style="margin-left: 5px;")
					ul.dropdown-menu(role="menu", style="margin-left: 15px;")
						li
							a Songs
							a Artists
							a Albums
							a Genre
		.library
			.tree
				ul.lib
					for artistsGroup in library
						li
							span
								i.glyphicon.glyphicon-folder-open
								= artistsGroup.artist
							ul
								for album in artistsGroup.albums
									li(style="display: none")
										span= album.title
										ul
											for track in album.tracks
												li(style="display: none")
													span.track(data-uid="#{track.uid}")= track.title
	.pending-list
			.list
				for track in data.playlist
					.song
						.info
							.song-title= track.title
							.song-artist= track.artist
							.song-infos= track.duration
						.play
							.button(data-uid="#{track.uid}", data-encoding="#{track.encoding}") Play
						.layer
							.top
							.left
							.right
							.bottom
block scripts
	script.
		$(function(){
			$('.track').on("dblclick", function(){
				var uidFile = $(this).data("uid");
				$.post("/playlist/add/".concat(uidFile), function(playlist){
					$("ul.playlist").empty();
					var tracknumber = 0;

					$.each(playlist.all, function(index, val){
						tracknumber += 1;
						var track = "\
							<li>\
								<a class='song' data-uid='{{uid}}'>\
									<div class='track-info track-px'>\
										<div class='track-info track-num'>\
											{{num}}\
										</div>\
										<div class='track-info track-time'>\
											{{time}}\
										</div>\
									</div>\
									<div class='track-info track'>\
										<div class='track-info track-title'>\
											{{title}}\
										</div>\
										<div class='track-info track-artist'>\
											{{artist}}\
										</div>\
									</div>\
								</a>\
							</li>";

						track = track.replace("{{uid}}", val.uid);
						track = track.replace("{{num}}", tracknumber);
						track = track.replace("{{time}}", val.duration);
						track = track.replace("{{title}}", val.title);
						track = track.replace("{{artist}}", val.artist);
						
						var track = $("ul.playlist").append(track);
					});

					var trackObj = playlist.lastAdded;

					var track ="\
					<div class='song'>\
						<div class='info'>\
							<div class='song-title'> " + trackObj.title + "</div>\
							<div class='song-artist'> " + trackObj.artist + "</div>\
							<div class='song-infos'> " + trackObj.duration + "</div>\
						</div>\
						<div class='play'>\
							<div class='button' data-uid='" + trackObj.uid + "'> Play</div>\
						</div>\
						<div class='layer'>\
							<div class='top'></div>\
							<div class='left'></div>\
							<div class='right'></div>\
							<div class='bottom'></div>\
						</div>\
					</div>";
					$('.pending-list .list').append(track);
					$.ongaku.controls.bind();

				});
			});
		});
