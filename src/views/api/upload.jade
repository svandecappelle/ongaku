section.sidebar.show
    .search(style="height:59px") 
        .col-lg-8.col-md-8
            .input-group
                h1 Upload files
    .user-sidebar.library-view
        .upload
            .input-group
                input(name="import", type="file")
            .progress
                .progress-bar(role="progressbar", aria-valuenow="0", aria-valuemin="0", aria-valuemax="100", style="width: 0%;")
        
        .panel(style="margin: 5px;")
            h2 Uploaded files:
            .container-fluid.imported-files.list-group(style="width: 80%; margin: auto; margin-top: 10px; line-height: 30px;")
                if directory
                    h2=directory
                if files
                    .row.list-group-item(style="text-align: center; font-weight: bold;")
                        .col-md-1
                            span Type
                        .col-md-9
                            span Name
                        .col-md-1
                            span Delete
                        .col-md-1
                            span Extract
                    for file in files
                        - var filename = file
                        - var target="_self"
                        if directory
                            - filename = file
                            - file=directory + "/" + file
                        if file.indexOf('.')!==-1 
                            - target = "_blank"
                        .row.list-group-item
                            .col-md-1
                                if (file.indexOf('.jpg')!==-1 || file.indexOf('.JPG')!==-1 || file.indexOf('.PNG')!==-1 || file.indexOf('.png')!==-1 || file.indexOf('.gif')!==-1 || file.indexOf('.GIF')!==-1)
                                    img(src="/upload/files/imported/#{file}", style="height: 30px;")
                                else
                                    i.fa.fa-file-o(style="font-size: 30px;")
                            .col-md-9.file.imported-file
                                a.imported-filename(href="/upload/files/imported/#{file}", target="#{target}")=filename
                            .col-md-1(style="text-align: center;")
                                a.delete.imported-filename(href="/upload/imported/#{file}/delete")
                                    i.fa.fa-remove
                            .col-md-1(style="text-align: center;")
                                if (file.indexOf('.zip')!==-1 || file.indexOf('.ZIP')!==-1 || file.indexOf('.tar')!==-1 || file.indexOf('.TAR')!==-1)
                                    a.extract.imported-filename(title="extract", href="/upload/imported/#{file}/extract")
                                        i.fa.fa-file-archive-o


script.
  function initView(){
    $('input[name=import]').customFile("Upload file");
    
    $("input[name=import]").liteUploader({
      script: "/upload/file"
    })
    .on("lu:progress", function (e, percentage) {
        $(".progress-bar").css({
            "width" : percentage + "%"
        });
        $(".progress-bar").text("Uploading: " + percentage + "%");
    })
    .on("lu:success", function (e, response) {
        $(".progress-bar").text("Uploaded: refreshing import list");
        setTimeout(function(){
            window.location.reload();
        }, 1000);
    });
  }